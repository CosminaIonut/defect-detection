[[0.00086654 0.00086654 0.00086654 ... 0.00086654 0.00086654 0.00086654]
 [0.00119113 0.00119113 0.00119113 ... 0.00119113 0.00119113 0.00119113]
 [0.00214098 0.00214098 0.00214098 ... 0.00214098 0.00214098 0.00214098]
 ...
 [0.03716586 0.0253569  0.01678278 ... 0.00258239 0.0016026  0.00215171]
 [0.0462074  0.03139693 0.02064352 ... 0.00283378 0.00160496 0.00229364]
 [0.05900354 0.03994516 0.02610747 ... 0.00318957 0.0016083  0.0024945 ]]
[[0.  ]
 [0.  ]
 [0.  ]
 ...
 [0.05]
 [0.05]
 [0.05]]
WARNING:tensorflow:Please fix your imports. Module tensorflow.python.training.tracking.data_structures has been moved to tensorflow.python.trackable.data_structures. The old module will be deleted in version 2.11.
Traceback (most recent call last):
  File "C:\MyDocuments\Disertatie\segments\wandb_visualization\overlap\wrapper_test_and_train.py", line 358, in <module>
    train_ANN()
  File "C:\MyDocuments\Disertatie\segments\wandb_visualization\overlap\wrapper_test_and_train.py", line 216, in train_ANN
    train_models_and_save(n_members,data,test_size,train_group, epochs, batch_size, learning_rate,optimizer,hidden_layer_size,patience,monitor)
  File "C:\MyDocuments\Disertatie\segments\wandb_visualization\overlap\test_and_train.py", line 33, in train_models_and_save
    network, history = train_model_sweep(build_nn_sweep_BNN(optimizer, learning_rate, hidden_layer_size,sample_size), x_train,
  File "C:\MyDocuments\Disertatie\segments\model_training\overlap\model_generating.py", line 212, in build_nn_sweep_BNN
    features = tfp.layers.DenseVariational(
  File "C:\Users\cosmi\anaconda3\envs\tf2.12\lib\site-packages\keras\utils\traceback_utils.py", line 70, in error_handler
    raise e.with_traceback(filtered_tb) from None
  File "C:\Users\cosmi\anaconda3\envs\tf2.12\lib\site-packages\tensorflow_probability\python\layers\dense_variational_v2.py", line 122, in call
    r = self._prior(inputs)
  File "C:\Users\cosmi\anaconda3\envs\tf2.12\lib\site-packages\tensorflow_probability\python\layers\distribution_layer.py", line 224, in __call__
    distribution, _ = super(DistributionLambda, self).__call__(
  File "C:\Users\cosmi\anaconda3\envs\tf2.12\lib\site-packages\tensorflow_probability\python\layers\distribution_layer.py", line 230, in call
    distribution, value = super(DistributionLambda, self).call(
  File "C:\Users\cosmi\anaconda3\envs\tf2.12\lib\site-packages\tensorflow_probability\python\layers\distribution_layer.py", line 170, in _fn
    d = make_distribution_fn(*fargs, **fkwargs)
  File "C:\MyDocuments\Disertatie\segments\model_training\overlap\model_generating.py", line 55, in <lambda>
    make_distribution_fn=lambda t: tfd.Normal(
  File "C:\Users\cosmi\anaconda3\envs\tf2.12\lib\site-packages\decorator.py", line 231, in fun
    args, kw = fix(args, kw, sig)
  File "C:\Users\cosmi\anaconda3\envs\tf2.12\lib\site-packages\decorator.py", line 203, in fix
    ba = sig.bind(*args, **kwargs)
  File "C:\Users\cosmi\anaconda3\envs\tf2.12\lib\inspect.py", line 3045, in bind
    return self._bind(args, kwargs)
  File "C:\Users\cosmi\anaconda3\envs\tf2.12\lib\inspect.py", line 3034, in _bind
    raise TypeError(
TypeError: Exception encountered when calling layer "distribution_lambda" "                 f"(type DistributionLambda).
got an unexpected keyword argument 'convert_to_tensor_fn'
Call arguments received by layer "distribution_lambda" "                 f"(type DistributionLambda):
  • inputs=tf.Tensor(shape=(None, 8), dtype=float32)
  • args=<class 'inspect._empty'>
  • kwargs={'training': 'None'}